---
layout: layouts/base.njk
---
<div class="page-nav-header">
    <p><a href="/photos/">← all</a></p>

    {% set nextAlbum = collections.photos | getNextCollectionItem(page) %}
    {% if not nextAlbum %}
        {% set nextAlbum = collections.photos | first %}
    {% endif %}
    {% if nextAlbum %}
        <p><a href="{{ nextAlbum.url }}">{{ nextAlbum.data.title }} →</a></p>
    {% endif %}
</div>

<div class="album-header">
    <h1>{{ title }}</h1>
    {% if description %}
        <p>{{ description }}</p>
    {% endif %}
    <p class="album-date">{{ date | albumDate }}</p>
</div>

<div class="album-page">
    {% set albumSlug = page.inputPath | getAlbumSlugFromPath %}
    {% set images = globalAlbumPhotos | getAlbum(albumSlug) %}
    {% if reverse %}
        {% set images = images | reverse %}
    {% endif %}

    <div class="gallery-grid">
        {% for image in images %}
            {% set imageSample = image.images.jpeg[0] %}
            {% set imageWidth = imageSample.width %}
            {% set imageHeight = imageSample.height %}

            <button
                class="gallery-item"
                id="{{ image.source | getImageNameFromPath | slugify | hash }}"
                aria-label="View photo {{ loop.index }}"
                data-full-src="{{ image.images.jpeg[image.images.jpeg.length - 1].url }}"
                data-image-metadata='{{ image | json | escape }}'
                style="aspect-ratio: {{ imageWidth }} / {{ imageHeight }};"
            >
                {% optmizedImageTag image, { sizes: "(min-width: 1920px) 20vw, (min-width: 1200px) 25vw, (min-width: 900px) 33vw, (min-width: 600px) 50vw, 100vw" } %}
            </button>
        {% endfor %}
    </div>
</div>

<div class="page-nav-header">
    {% set prevAlbum = collections.photos | getPreviousCollectionItem(page) %}
    {% if not prevAlbum %}
        {% set prevAlbum = collections.photos | last %}
    {% endif %}
    {% if prevAlbum %}
        <p><a href="{{ prevAlbum.url }}">← {{ prevAlbum.data.title }}</a></p>
    {% endif %}

    {% set nextAlbum = collections.photos | getNextCollectionItem(page) %}
    {% if not nextAlbum %}
        {% set nextAlbum = collections.photos | first %}
    {% endif %}
    {% if nextAlbum %}
        <p><a href="{{ nextAlbum.url }}">{{ nextAlbum.data.title }} →</a></p>
    {% endif %}
</div>

<!-- Lightbox -->
<div id="lightbox" class="lightbox" aria-hidden="true" role="dialog">
    <button class="lightbox-close" aria-label="Close lightbox">
        <svg
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-linecap="round"
            stroke-linejoin="round"
        >
            <line x1="18" y1="6" x2="6" y2="18"></line>
            <line x1="6" y1="6" x2="18" y2="18"></line>
        </svg>
    </button>
    <button class="lightbox-prev nav-arrow" aria-label="Previous photo">
        ◀
    </button>
    <div class="lightbox-content" id="lightbox-content">
        <img id="lightbox-img" src="" alt="">
    </div>
    <button class="lightbox-next nav-arrow" aria-label="Next photo">▶</button>
</div>

<script type="module" src="/assets/js/gallery.js"></script>
<script src="/assets/js/masonry.js"></script>
<script defer>
    const breakpoints = [
        { width: 1920, columns: 5 },
        { width: 1200, columns: 4 },
        { width: 900, columns: 3 },
        { width: 600, columns: 2 },
        { width: 0, columns: 1 },
    ];

    initMasonry(".gallery-grid", breakpoints);
</script>
